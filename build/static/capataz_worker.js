//! capataz 0.1.7-beta

!function(self){"use strict";self.onmessage=function(e){var s=JSON.parse(e.data);s.error="Worker is not ready yet.",self.postMessage(JSON.stringify(s))},importScripts("require.js"),require(["creatartis-base"],function(base){self.base=base;var CODE='(function () {"use strict";\n\treturn base.Future.imports.apply(this, $imports).then(function (deps) {\n\t\treturn ($fun).apply(this, deps.concat($args));\n\t});\n})()';self.onmessage=function onmessage(msg){var data=JSON.parse(msg.data),code=CODE.replace("$imports",JSON.stringify(data.imports||[])).replace("$fun",data.fun).replace("$args",JSON.stringify(data.args||[]));base.Future.invoke(eval,self,code).then(function(e){data.result=e,self.postMessage(JSON.stringify(data))},function(e){data.error='Execution failed with "'+e+'"!\nCode:\n'+code+"\nCallstack:\n\t"+base.callStack(e).join("\n\t"),self.postMessage(JSON.stringify(data))})},self.postMessage("Ready")})}(self);