//! creatartis-base 0.1.8

(function(t){"use strict";"function"==typeof define&&define.amd?define(["sermat"],t):"object"==typeof exports&&module.exports?module.exports=t(require("sermat")):this.base=t(this.Sermat)}).call(this,function __init__(Sermat){"use strict";var exports={__package__:"creatartis-base",__name__:"base",__init__:__init__,__dependencies__:[Sermat],__SERMAT__:{include:[]}},global=exports.global=Function("return this;")(),raise=exports.raise=function(){throw new Error(Array.prototype.slice.call(arguments,0).join(""))},raiseIf=exports.raiseIf=function(t){t&&raise.apply(this,Array.prototype.slice.call(arguments,1))},callStack=exports.callStack=function(r){if(r)return(r.stack||r.stacktrace||"").split("\n");try{throw new Error}catch(t){r=t}return(r.stack||r.stacktrace||"").split("\n").slice(1)},obj=exports.obj=function(){for(var t={},r=0;r<arguments.length;r+=2)t[arguments[r]+""]=arguments[r+1];return t},copy=exports.copy=function(t){var r,n,e=1;for(arguments.length<2&&(t={},e=0);e<arguments.length;e++)for(r in n=arguments[e])n.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(t[r]=n[r]);return t};Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");if(arguments.length<1)return this;var r=Array.prototype.slice.call(arguments,1),n=this,e=function(){},i=function(){return n.apply(t,r.concat(Array.prototype.slice.call(arguments)))};return e.prototype=this.prototype,i.prototype=new e,i}),String.prototype.repeat||(String.prototype.repeat=function(t){return(t|=0)<=0?"":1&t?this+this.repeat(t-1):(this+this).repeat(t>>1)});var objects=exports.objects=function(){var o=this.subconstructor=function(t,r){return"function"!=typeof r&&(r=function(){t.apply(this,arguments)}),r.prototype=Object.create(t.prototype),r.prototype.constructor=r,Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t,r},s=this.addMember=function(t,r,n,e){var i=r.split(/\s+/);r=i.pop(),(0<=i.indexOf("dual")?[t,t.prototype]:0<=i.indexOf("static")?[t]:[t.prototype]).forEach(function(t){if(e||void 0===t[r])return 0<=i.indexOf("property")?Object.defineProperty(t,r,n):0<=i.indexOf("const")?Object.defineProperty(t,r,{get:function(){return n},set:function(){throw new Error(r+" is readonly!")},enumerable:!0,configurable:!1}):t[r]=n})},a=this.addMembers=function(r,n,e){Object.keys(n).map(function(t){s(r,t,n[t],e)})};exports.declare=this.declare=function(){var t=Array.prototype.slice.call(arguments),r=1<t.length?t.shift():Object,n=0<t.length?t.pop():{},e=o(r,n.hasOwnProperty("constructor")?n.constructor:void 0),i=n[""];return Object.keys(n).map(function(t){""!==t&&"constructor"!==t&&s(e,t,n[t],!0)}),t.forEach(function(t){"function"==typeof t&&(t=t.prototype),a(e,t,!1)}),"function"==typeof i&&i.apply(e),e},this.unimplemented=function(t,r){return function(){throw new Error((t||this.constructor.name)+"."+r+" not implemented! Please override.")}};return this}.call({}),declare=objects.declare;exports.enum=function(t){1<arguments.length&&(t=Array.prototype.slice.call(arguments)),raiseIf(t.length<1,"Empty key set for enum!");for(var r,n={},e=0;e<t.length;e++)r=t[e]+"",raiseIf((0|r)+""===r,"Invalid key '",r,"' for enum!"),raiseIf(n.hasOwnProperty(r),"Repeated key '",r,"' in enum!"),n[r]=e,n[e]=r;return Object.freeze(n)};var XML_ENTITIES={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},Text=exports.Text=declare({constructor:function(){this.clear()},clear:function(){var t=this.text;return this.text="",t},add:function(){for(var t=0;t<arguments.length;t++)this.text+=arguments[t]},toString:function(){return this.text},escapeXML:function(t){var r=this.XML_ENTITIES;return(t+"").replace(/[&<>"']/g,function(t){return r[t]})},XML_ENTITIES:XML_ENTITIES,"static XML_ENTITIES":XML_ENTITIES,addXML:function(){for(var t=0;t<arguments.length;t++)this.text+=this.escapeXML(arguments[t])},escapeRegExp:function(t){return(t+"").replace(/[\-\[\]{}()*+?.^$\\]/g,"\\$&")},formatDate:function(r,t,n){r=r||new Date;var e=Text.lpad;return t?t.replace(/(y+|m+|d+|h+|H+|n+|s+|S+|a+|A+|"[^"]*")/g,function(t){switch(t.charAt(0)){case"y":return e((n?r.getUTCFullYear():r.getFullYear())+"",t.length,"0");case"m":return e((n?r.getUTCMonth():r.getMonth())+1+"",t.length,"0");case"d":return e((n?r.getUTCDate():r.getDate())+"",t.length,"0");case"h":return e((n?r.getUTCHours():r.getHours())+"",t.length,"0");case"H":return e((n?r.getUTCHours():r.getHours())%12+"",t.length,"0");case"n":return e((n?r.getUTCMinutes():r.getMinutes())+"",t.length,"0");case"s":return e((n?r.getUTCSeconds():r.getSeconds())+"",t.length,"0");case"S":return e((n?r.getUTCMilliseconds():r.getMilliseconds())+"",t.length,"0");case"a":return["am","pm"][~~((n?r.getUTCHours():r.getHours())/12)].substr(0,t.length);case"A":return["AM","PM"][~~((n?r.getUTCHours():r.getHours())/12)].substr(0,t.length);case'"':return t.substr(1,t.length-2);default:return t}}):r.toString()},addDate:function(t,r,n){this.text+=this.formatDate(t,r,n)},"static lpad":function(t,r,n){return isNaN(r)||t.length>=r?t:((n=(n||" ")+"").repeat((r-t.length)/n.length+1)+t).substr(-r)},"static rpad":function(t,r,n){return isNaN(r)||t.length>=r?t:(t+(n=(n||" ")+"").repeat((r-t.length)/n.length+1)).substr(0,r)},"static hashCode":function(t){for(var r=0,n=t.length,e=0;e<n;++e)r=31*r+t.charCodeAt(e)&2147483647;return r}});Text.escapeXML=Text.prototype.escapeXML,Text.escapeRegExp=Text.prototype.escapeRegExp,Text.formatDate=Text.prototype.formatDate;var math=exports.math={};math.clamp=function(t,r,n){return Math.min(n,Math.max(r,t))},math.sign=function(t){return 0===(t=+t)||isNaN(t)?t:0<t?1:-1};var factorial=math.factorial=function(t,r){if(t|=0,r=Math.max(0,0|r),t<0)return NaN;for(var n=1;r<t;--t)n*=t;return n};math.combinations=function(t,r){return factorial(t,r)/factorial(t-r)},math.gauss_pdf=function(t,r,n){r=isNaN(r)?0:+r,n=isNaN(n)?1:+n;var e=Math.sqrt(n);return Math.exp(-Math.pow(x-r,2)/(2*n))/e*Math.sqrt(2*Math.PI)},math.gauss_erfc=function(t){var r=Math.abs(t),n=1/(1+.5*r),e=n*Math.exp(-r*r-1.26551223+n*(1.00002368+n*(.37409196+n*(.09678418+n*(n*(.27886807+n*(n*(1.48851587+n*(.17087277*n-.82215223))-1.13520398))-.18628806)))));return 0<=t?e:2-e},math.gauss_cdf=function(t,r,n){r=isNaN(r)?0:+r,n=isNaN(n)?1:+n;var e=Math.sqrt(n);return math.gauss_erfc(-(t-r)/(e*Math.sqrt(2)))/2};var functions=exports.functions={};functions.I=functions.id=function(t){return t},functions.K=function(t){return t},functions.S=function(t,r,n){return t.call(this,n,r.call(this,n))},functions.__infixOperator__=function(t){return new Function("x","y","return (x "+t+" y);")},"+ * - / % < > <= >= == === != !== & | ^ << >> >>> && || in instanceof".split(/\s+/).forEach(function(t){var r=functions.__infixOperator__(t);functions[t]=r,functions["("+t+")"]=r}),functions["~"]=functions["~()"]=new Function("x","return ~x;"),functions["!"]=functions["!()"]=new Function("x","return !x;"),functions["+()"]=new Function("x","return +x;"),functions["-()"]=new Function("x","return -x;"),functions.typeof=functions["typeof()"]=new Function("x","return typeof x;"),functions.void=functions["void()"]=new Function("x","return void x;"),functions["."]=functions["(.)"]=new Function("x","y","return x[y];"),functions["?:"]=functions["(?:)"]=new Function("x","y","z","return x ? y : z;");var Type=exports.Type=declare({constructor:function(t){if("function"==typeof(t=t||{}).isType&&(this.isType=t.isType),"function"==typeof t.isCompatible&&(this.isCompatible=t.isCompatible),"function"==typeof t.coerce&&(this.coerce=t.coerce),"string"==typeof t.toString){var r=t.toString;this.toString=function(){return r}}},isType:function(t){return!1},isCompatible:function(t){return this.isType(t)},coerce:function(t){throw this.incompatibleError(t)},incompatibleError:function(t){return new TypeError("Value "+t+" is not compatible with type "+this+".")}}),types=exports.types={};types.BOOLEAN=new Type({isType:function(t){return"boolean"==typeof t||null!=t&&t.constructor===Boolean},isCompatible:function(t){return!0},coerce:function(t){return!!t},toString:"boolean"}),types.NUMBER=new Type({isType:function(t){return"number"==typeof t||null!=t&&t.constructor===Number},isCompatible:function(t){return!0},coerce:function(t){return+t},toString:"number"}),types.STRING=new Type({isType:function(t){return"string"==typeof t||null!=t&&t.constructor===String},isCompatible:function(t){return!0},coerce:function(t){return""+t},toString:"string"}),types.FUNCTION=new Type({isType:function(t){return"function"==typeof t||null!=t&&t.constructor===Function},toString:"function"}),types.INTEGER=new Type({isType:function(t){return(0|t)===t},isCompatible:function(t){return!isNaN(t)},coerce:function(t){return 0|+t},toString:"integer"}),types.CHARACTER=new Type({isType:function(t){return types.STRING.isType(t)&&1===t.length},isCompatible:function(t){return 0<(""+t).length},coerce:function(t){return(""+t).charAt(0)},toString:"character"}),types.OBJECT=new Type({isType:function(t){return"object"==typeof t},isCompatible:function(t){return"function"!=typeof t},coerce:function(t){switch(typeof t){case"function":throw this.incompatibleError(t);case"object":return t;default:return Object(t)}},toString:"object"});var ObjectType=types.ObjectType=declare(Type,{constructor:function(t){Type.call(this,{}),t.hasOwnProperty("constructor")&&"function"==typeof def.constructor?(this.instanceOf=t.constructor,delete t.constructor):this.instanceOf=null,this.members=t.members||{}},isType:function(t){if("object"!=typeof t)return!1;if(this.instanceOf&&!(t instanceof this.instanceOf))return!1;for(var r in this.members)if(!this.members[r].isType(t[r]))return!1;return!0},isCompatible:function(t){if("object"!=typeof t)return!1;if(this.instanceOf&&!(t instanceof this.instanceOf))return!1;for(var r in this.members)if(!this.members[r].isCompatible(t[r]))return!1;return!0},coerce:function(t){var r=this.instanceOf?new this.instanceOf(t):{};for(var n in this.members)r[n]=this.members[n].coerce(t[n]);return r}});types.ARRAY=new Type({isType:function(t){return Array.isArray(t)},isCompatible:function(t){return this.isType(t)||"string"==typeof t},coerce:function(t){if(this.isType(t))return t;if("string"==typeof t)return t.split("");throw this.incompatibleError(t)},toString:"array"});var ArrayType=types.ArrayType=declare({constructor:function(t,r){Type.call(this,{}),t?Array.isArray(t)?(this.elementTypes=t,this.length=isNaN(r)?this.elementTypes.length:Math.max(+r,this.elementTypes.length)):(this.elementTypes=[t],this.length=+r):(this.elementTypes=[],this.length=+r)},isType:function(t){if(!Array.isArray(t)||!isNaN(this.length)&&t.length!==this.length)return!1;if(this.elementTypes)for(var r=0,n=t.length;r<n;r++)if(!this.elementTypes[Math.min(this.elementTypes.length-1,r)].isType(t[r]))return!1;return!0},isCompatible:function(t){if(!Array.isArray(t)){if("string"!=typeof t)return!1;t=t.split("")}if(!isNaN(this.length)||t.length<+this.length)return!1;if(this.elementTypes)for(var r=0,n=t.length;r<n;r++)if(!this.elementTypes[Math.min(this.elementTypes.length-1,r)].isCompatible(t[r]))return!1;return!0},coerce:function(t){if(Array.isArray(t))t=t.slice();else{if("string"!=typeof t)throw this.incompatibleError(t);t=t.split("")}if(!isNaN(this.length))if(t.length>this.length)t=t.slice(0,this.length);else if(t.length<this.length)throw this.incompatibleError(t);if(this.elementTypes)for(var r,n=0,e=t.length;n<e;n++)r=this.elementTypes[Math.min(this.elementTypes.length-1,n)],t[n]=r.coerce(t[n]);return t}}),Initializer=exports.Initializer=declare({constructor:function(t,r){this.subject=t||{},this.args=r||{}},get:function(t,r){var n,e;if(r=r||{},this.args.hasOwnProperty(t))n=this.args[t];else{if(!r.hasOwnProperty("defaultValue"))throw new Error(r.missingValueError||"Missing argument <"+t+">!");n=r.defaultValue}if((e=r.type)&&!e.isType(n)){if(!r.coerce)throw new Error(r.typeMismatchError||"Value for <"+t+"> must be a "+e+"!");n=e.coerce(n)}if(r.regexp&&!r.regexp.exec(n))throw new Error(r.invalidValueError||"Value <"+n+"> for <"+t+"> does not match "+r.regexp+"!");if(r.hasOwnProperty("minimum")&&r.minimum>n)throw new Error(r.invalidValueError||"Value <"+n+"> for <"+t+"> must be greater than or equal to "+r.minimum+"!");if(r.hasOwnProperty("maximum")&&r.maximum<n)throw new Error(r.invalidValueError||"Value <"+n+"> for <"+t+"> must be less than or equal to "+r.maximum+"!");return"function"==typeof r.check&&r.check.call(this.subject,n,t,r),n},attr:function(t,r){r=r||{};try{if(r.hasOwnProperty("overwrite")&&!r.overwrite&&this.subject.hasOwnProperty(t))throw new Error(r.attrOverwriteError||"Attribute <"+t+"> is already defined!");this.subject[t]=this.get(t,r)}catch(t){if(!r.ignore)throw t}return this},bool:function(t,r){return(r=r||{}).type=types.BOOLEAN,this.attr(t,r)},string:function(t,r){return(r=r||{}).type=types.STRING,this.attr(t,r)},number:function(t,r){return(r=r||{}).type=types.NUMBER,this.attr(t,r)},integer:function(t,r){return(r=r||{}).type=types.INTEGER,this.attr(t,r)},func:function(t,r){return(r=r||{}).type=types.FUNCTION,this.attr(t,r)},array:function(t,r){return(r=r||{}).hasOwnProperty("length")||r.hasOwnProperty("elementType")?r.type=new types.ArrayType(r.elementType,r.length):r.type=types.ARRAY,this.attr(t,r)},object:function(t,r){return(r=r||{}).type=types.OBJECT,this.attr(t,r)}}),initialize=exports.initialize=function(t){var r={};return Array.prototype.forEach.call(arguments,function(t){r=Object.assign(r,t)}),new Initializer(t,r)},STOP_ITERATION=new Error("Sequence has ended."),Iterable=exports.Iterable=declare({constructor:function t(r){if(null==r)throw new Error("Iterable source is null or undefined.");"function"==typeof r?this.__iter__=r:"string"==typeof r?this.__iter__=t.__iteratorFromString__(r):Array.isArray(r)?this.__iter__=t.__iteratorFromArray__(r):"object"==typeof r?"function"==typeof r.__iter__?this.__iter__=r.__iter__.bind(r):this.__iter__=t.__iteratorFromObject__(r):this.__iter__=t.__iteratorSingleton__(r)},"dual STOP_ITERATION":STOP_ITERATION,"dual stop":function(){throw STOP_ITERATION},"dual catchStop":function(t){if(t!==STOP_ITERATION)throw t},"static __iteratorFromArray__":function(r){return function(){var t=0;return function(){if(t<r.length)return r[t++];throw STOP_ITERATION}}},"static __iteratorFromString__":function(r){return function(){var t=0;return function(){if(t<r.length)return r.charAt(t++);throw STOP_ITERATION}}},"static __iteratorFromObject__":function(n){return function(){var r=Object.keys(n);return function(){if(0<r.length){var t=r.shift();return[t,n[t]]}throw STOP_ITERATION}}},"static __iteratorSingleton__":function(r){return function(){var t=!1;return function(){if(t)throw STOP_ITERATION;return t=!0,r}}},isEmpty:function(){try{return this.__iter__()(),!1}catch(t){return this.catchStop(t),!0}},count:function(){var r=0;return this.forEach(function(t){r++}),r},length:function(){return this.count()},indexOf:function(t,r){r|=0;var n,e=this.__iter__(),i=0;try{for(n=e();;n=e(),++i)if(r<=i&&n===t)return i}catch(t){this.catchStop(t)}return-1},indicesOf:function(n,e){return e|=0,this.filter(function(t,r){return e<=r&&t===n},function(t,r){return r})},indexWhere:function(t,r){r|=0;var n,e=this.__iter__(),i=0;try{for(n=e();;n=e(),++i)if(r<=i&&t(n,i))return i}catch(t){this.catchStop(t)}return-1},indicesWhere:function(n,e){return e|=0,this.filter(function(t,r){return e<=r&&n(t)},function(t,r){return r})},forEach:function(t,r){var n,e,i=this.__iter__(),o=0;try{for(n=i();;n=i(),o++)r&&!r(n,o)||(e=t(n,o))}catch(t){this.catchStop(t)}return e},forEachApply:function(n,t,e){return e=e||this,this.forEach(function(t,r){return n.apply(e,t.concat([r]))},t)},map:function(e,i){var o=this;return new Iterable(function(){var t,r=o.__iter__(),n=-1;return function(){for(t=r();;t=r())if(n++,t=e?e(t,n):t,!i||i(t,n))return t;throw STOP_ITERATION}})},mapApply:function(n,t,e){return e=e||this,this.map(function(t,r){return n.apply(e,t.concat([r]))},t)},select:function(r){return this.map(function(t){return function r(n,e){if(Array.isArray(e))return e.map(r.bind(null,n));if("object"==typeof e){var i={};return Object.keys(e).forEach(function(t){i[t]=r.call(null,n,e[t])}),i}return"function"==typeof e?e(n):n[e]}(t,r)})},filter:function(e,i){var o=this;return new Iterable(function(){var t,r=o.__iter__(),n=-1;return function(){for(;;)if(t=r(),n++,e?e(t,n):t)return i?i(t,n):t;throw STOP_ITERATION}})},filterApply:function(n,e,i){return i=i||this,this.filter(function(t,r){return n.apply(i,t.concat([r]))},e&&function(t,r){return e.apply(i,t.concat([r]))})},takeWhile:function(e){var i=this;return new Iterable(function(){var r=i.__iter__(),n=0;return function(){if(0<=n){var t=r();if(e(t,n))return n++,t;n=-1/0}i.stop()}})},take:function(n){return n=isNaN(n)?1:0|n,this.takeWhile(function(t,r){return r<n})},dropWhile:function(i){var t=this;return new Iterable(function(){var r=t.__iter__(),n=0,e=!0;return function(){for(var t;t=r(),e=e&&i(t,n),n++,e;);return t}})},drop:function(n){return n=isNaN(n)?1:0|n,this.dropWhile(function(t,r){return r<n})},head:function(r){try{return this.__iter__()()}catch(t){if(this.catchStop(t),arguments.length<1)throw new Error("Tried to get the head value of an empty Iterable.");return r}},tail:function(){var r=this;return new Iterable(function(){var t=r.__iter__();try{t()}catch(t){throw this.catchStop(t),new Error("Tried to get the tail of an empty Iterable.")}return t})},last:function(r){var n,e=!0,t=this.__iter__();try{for(e=!0;;e=!1)n=t()}catch(t){if(this.catchStop(t),e){if(arguments.length<1)throw new Error("Tried to get the last value of an empty Iterable.");return r}return n}},init:function(){var t=this;return new Iterable(function(){var r,n=t.__iter__();try{r=n()}catch(t){throw this.catchStop(t),new Error("Tried to get the init of an empty Iterable.")}return function(){var t=r;return r=n(),t}})},greater:function(r){r="function"==typeof r?r:function(t){return+t};var n,e=-1/0,i=[];return this.forEach(function(t){n=r(t),e<n?(e=n,i=[t]):e==n&&i.push(t)}),i},lesser:function(r){r="function"==typeof r?r:function(t){return+t};var n,e=1/0,i=[];return this.forEach(function(t){(n=r(t))<e?(e=n,i=[t]):e==n&&i.push(t)}),i},sample:function(i,o){if((i|=0)<1)return Iterable.EMPTY;o=o||Randomness.DEFAULT;var s=[];return this.forEach(function(t,r){for(var n=o.random(),e=s.length;0<e&&s[e-1][0]<n;--e);for(s.splice(e,0,[n,t,r]);s.length>i;)s.pop()}),s.sort(function(t,r){return t[2]-r[2]}),new Iterable(s.map(function(t){return t[1]}))},foldl:function(t,r){var n,e=this.__iter__();try{for(r=void 0===r?e():r,n=e();;n=e())r=t(r,n)}catch(t){this.catchStop(t)}return r},scanl:function(e,i){var o=this;return new Iterable(function(){var t,r=o.__iter__(),n=-1;return function(){return t=0===++n?void 0===i?r():i:e(t,r())}})},foldr:function(n,t){return this.reverse().foldl(function(t,r){return n(r,t)},t)},scanr:function(n,t){return this.reverse().scanl(function(t,r){return n(r,t)},t)},sum:function(t){var r=isNaN(t)?0:+t;return this.forEach(function(t){r+=+t}),r},min:function(t){var r=isNaN(t)?1/0:+t;return this.forEach(function(t){(t=+t)<r&&(r=t)}),r},max:function(t){var r=isNaN(t)?-1/0:+t;return this.forEach(function(t){r<(t=+t)&&(r=t)}),r},all:function(n,e){n="function"==typeof n?n:function(t){return!!t};var i=!0;return this.forEach(function(t,r){if(!n(t,r)&&(i=!1,!e))throw STOP_ITERATION}),i},any:function(n,e){n="function"==typeof n?n:function(t){return!!t};var i=!1;return this.forEach(function(t,r){if(n(t,r)&&(i=!0,!e))throw STOP_ITERATION}),i},join:function(n){var e="";return n=""+(n||""),this.forEach(function(t,r){e+=0===r?t:n+t}),e},toArray:function(r){return r=r||[],this.forEach(function(t){r.push(t)}),r},toObject:function(r){return r=r||{},this.forEach(function(t){r[t[0]]=t[1]}),r},reverse:function(){return new Iterable(this.toArray().reverse())},sorted:function(t){return new Iterable(this.toArray().sort(t))},permutations:function(s){s|=0;var a=this.toArray(),u=a.length;if(s<1||u<s)return Iterable.EMPTY;var c=math.factorial(u)/math.factorial(u-s);return new Iterable(function(){var i=0,o=Iterable.range(u).toArray();return function(){if(i<c){for(var t=new Array(s),r=o.slice(),n=i,e=0;e<s;++e)t[e]=a[r.splice(n%(u-e),1)[0]],n=n/(u-e)|0;return++i,t}throw STOP_ITERATION}})},combinations:function(o){o|=0;var s=this.toArray(),a=s.length;return o<1||a<o?Iterable.EMPTY:new Iterable(function(){var e=Iterable.range(o).toArray(),i=e.map(function(t){return s[t]});return function(){if(!i)throw STOP_ITERATION;for(var t=i,r=o-1;0<=r&&e[r]===r+a-o;--r);if(r<0)i=null;else{e[r]+=1;for(var n=r+1;n<o;++n)e[n]=e[n-1]+1;i=e.map(function(t){return s[t]})}return t}})},slices:function(e){var t=this;return e=isNaN(e)||e<1?1:0|e,new Iterable(function(){var r,n=t.__iter__();return function(){r=[];try{for(var t=0;t<e;++t)r.push(n())}catch(t){if(t!==STOP_ITERATION)throw t}if(0<r.length)return r;throw STOP_ITERATION}})},groupBy:function(s){var a=this;return new Iterable(function(){var e,i=a.__iter__(),o=null;try{o=[i()],e=s?s(o[0]):o[0]}catch(t){a.catchStop(t)}return function(){var t,r,n;if(o)for(;;)try{if(t=i(),(r=s?s(t):t)!==e)return n=[e,o],e=r,o=[t],n;o.push(t)}catch(t){return a.catchStop(t),n=[e,o],o=null,n}else a.stop()}})},groupAll:function(){function t(t){return t+""}function r(t,r){return(t=t||[]).push(r),t}return function(e,i){var o={};return e=e||t,i=i||r,this.forEach(function(t,r){var n=e(t,r);o[n]=i(o[n],t,r)}),o}}(),"static zipWith":function(n){var t=Array.prototype.slice.call(arguments,1).map(iterable);return new Iterable(function(){var r=t.map(function(t){return t.__iter__()});return function(){var t=r.map(function(t){return t()});return n?n.apply(null,t):t}})},zipWith:function(t){var r=[t,this].concat(Array.prototype.slice.call(arguments,1));return this.constructor.zipWith.apply(this.constructor,r)},"static zip":function(){var t=[null].concat(Array.prototype.slice.call(arguments));return this.zipWith.apply(this,t)},zip:function(){var t=[null,this].concat(Array.prototype.slice.call(arguments));return this.constructor.zipWith.apply(this.constructor,t)},product:function(){var i=Array.prototype.slice.call(arguments).map(iterable);return i.unshift(this),new Iterable(function(){var n,e;return function(){if(n){if(!e)throw STOP_ITERATION;for(var r=n.length-1;0<=r;--r)try{e[r]=n[r]();break}catch(t){if(!(0<r&&t===STOP_ITERATION))throw e=null,t;n[r]=i[r].__iter__(),e[r]=n[r]()}}else n=i.map(function(t){return t.__iter__()}),e=n.map(function(t){return t()});return e.slice(0)}})},"static product":function(t){return t=t?iterable(t):this.EMPTY,this.prototype.product.apply(t,Array.prototype.slice.call(arguments,1))},chain:function(){var e=Array.prototype.slice.call(arguments).map(iterable);return e.unshift(this),new Iterable(function(){var r=0,n=e[0].__iter__();return function(){for(;;)try{return n()}catch(t){if(!(t===STOP_ITERATION&&r+1<e.length))throw t;n=e[++r].__iter__()}throw STOP_ITERATION}})},"static chain":function(t){return t=t?iterable(t):this.EMPTY,this.prototype.chain.apply(t,Array.prototype.slice.call(arguments,1))},flatten:function(){var t=this;return new Iterable(function(){var r=t.__iter__(),n=this.stop;return function(){for(;;)try{return n()}catch(t){t===STOP_ITERATION&&(n=iterable(r()).__iter__())}throw STOP_ITERATION}})},nub:function(n){var e=[];return this.filter(function(t){if(n){for(var r=e.length-1;0<=r;--r)if(n(e[r],t))return!1}else if(0<=e.indexOf(t))return!1;return e.push(t),!0})},union:function(){var t=[void 0].concat(Array.prototype.slice.call(arguments));return this.unionBy.apply(this,t)},unionBy:function(t){return this.chain.apply(this,Array.prototype.slice.call(arguments,1)).nub(t)},intersection:function(){var t=[void 0].concat(Array.prototype.slice.call(arguments));return this.intersectionBy.apply(this,t)},intersectionBy:function(n){for(var e=this.toArray(),t=1;t<arguments.length;++t)e=iterable(arguments[t]).filter(function(t){if(n){for(var r=e.length-1;0<=r;--r)if(n(e[r],t))return!0;return!1}return 0<=e.indexOf(t)}).toArray();return iterable(e)},difference:function(){var t=[void 0].concat(Array.prototype.slice.call(arguments));return this.differenceBy.apply(this,t)},differenceBy:function(n){for(var e,t=this,r=1;r<arguments.length;++r)e=iterable(arguments[r]).toArray(),t=t.filter(function(t){if(n){for(var r=e.length-1;0<=r;--r)if(n(e[r],t))return!1;return!0}return e.indexOf(t)<0});return t},"static range":function(n,e,i){switch(arguments.length){case 0:e=n=0,i=1;break;case 1:e=n,n=0,i=1;break;case 2:i=1}return new Iterable(function(){var t,r=n;return function(){if(isNaN(r)||isNaN(e)||e<=r)throw STOP_ITERATION;return t=r,r+=i,t}})},"static repeat":function(r,n){return n=isNaN(n)?1/0:+n,new Iterable(function(){var t=n;return function(){if(--t<0)throw STOP_ITERATION;return r}})},"static iterate":function(e,t,i){return i=isNaN(i)?1/0:+i,new Iterable(function(){var r=i,n=t;return function(){if(--r<0)throw STOP_ITERATION;var t=n;return n=e(n),t}})},cycle:function(t){t=void 0===t?1/0:+t;var e=this;return new Iterable(function(){var r=t,n=e.__iter__();return function(){for(;0<r;)try{return n()}catch(t){if(!(t===STOP_ITERATION&&1<r))throw t;r--,n=e.__iter__()}throw STOP_ITERATION}})},toString:function(t){t=0|t||5;var r=this.take(t+1).toArray();return r.length>t?(r.pop(),"Iterable("+JSON.stringify(r).replace(/\]$/," ...]")+")"):"Iterable("+JSON.stringify(r)+")"}});Iterable.EMPTY=new Iterable(function(){return Iterable.prototype.stop});var iterable=exports.iterable=function(t){return null!=t&&"function"==typeof t.__iter__?t:new Iterable(t)},Future=exports.Future=declare({constructor:function(t){this.state=0,this.callbacks=[[],[],[]],0<arguments.length&&this.resolve(t)},__future__:function(){return this},"static __isFuture__":function(t){return null!=t&&"function"==typeof t.__future__},STATES:["pending","resolved","rejected","cancelled"],isPending:function(){return 0===this.state},isResolved:function(){return 1===this.state},isRejected:function(){return 2===this.state},isCancelled:function(){return 3===this.state},__complete__:function(r,n,t){return 0===this.state&&(this.state=t,this.__completion__=[r,n],this.callbacks[t-1].forEach(function(t){"function"==typeof t&&setTimeout(t.bind(r,n),1)})),this},resolve:function(t,r){return 0===this.state?this.__complete__(r||this,t,1):this},reject:function(t,r){if(0===this.state&&(this.__complete__(r||this,t,2),this.callbacks[1].length<1))throw t instanceof Error?t:new Error(t);return this},cancel:function(t){return 0===this.state?this.__complete__(this,t,3):this},toString:function(){return"Future:"+this.STATES[this.state]},__register__:function(t,r){if("function"==typeof t)return 0===this.state?this.callbacks[r-1].push(t):this.state===r&&setTimeout(t.bind(this.__completion__[0],this.__completion__[1]),1),this;throw new Error("Callback must be a function, and not ("+t+")!")},done:function(){for(var t=0;t<arguments.length;t++)this.__register__(arguments[t],1);return this},fail:function(){for(var t=0;t<arguments.length;t++)this.__register__(arguments[t],2);return this},__onCancel__:function(){for(var t=0;t<arguments.length;t++)this.__register__(arguments[t],3);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},bind:function(t){return t.done(this.resolve.bind(this)),t.fail(this.reject.bind(this)),t.__onCancel__(this.cancel.bind(this)),this},then:function(r,n){var e=new Future;return this.done(function(t){try{t=r?r(t):t,__isFuture__(t)?e.bind(t.__future__()):e.resolve(t)}catch(t){e.reject(t)}}),this.fail(function(t){if(n)try{t=n(t),__isFuture__(t)?e.bind(t.__future__()):e.resolve(t)}catch(t){e.reject(t)}else e.reject(t)}),this.__onCancel__(e.cancel.bind(e)),e},"static when":function(t){return __isFuture__(t)?t.__future__():new Future(t)},"static then":function(t,r,n){return __isFuture__(t)?t.__future__().then(r,n):r(t)},"static invoke":function(t,r){try{return when(t.apply(r,Array.prototype.slice.call(arguments,2)))}catch(t){var n=new Future;return n.reject(t),n}},"static all":function(t){t=Array.isArray(t)?t:iterable(t).toArray();var r,n=new Future,e=t.length,i=new Array(e),o=function(t,r){i[t]=r,--e<1&&n.resolve(i)};if(e<1)n.resolve([]);else for(var s=0;s<t.length;s++)(r=when(t[s])).done(o.bind(this,s)),r.fail(n.reject.bind(n)),r.__onCancel__(n.cancel.bind(n));return n},"static any":function(t){t=iterables.iterable(t).toArray();var r,n=new Future,e=t.length,i=new Array(e);if(e<1)n.reject();else for(var o=0;o<t.length;o++)(r=when(t[o])).fail(function(r){return function(t){i[r]=t,--e<1&&n.reject(t)}}(o)),r.done(n.resolve.bind(n)),r.__onCancel__(n.cancel.bind(n));return n},"static sequence":function(t,n){var e,i=new Future,o=i.reject.bind(i),s=iterable(t).__iter__();return function t(r){try{return e=s(),n?when(e).then(n,o).then(t,o):when(e).then(t,o)}catch(t){t===STOP_ITERATION?i.resolve(r):i.reject(t)}}(),i},"static doWhile":function(e,t){t=t||function(t){return!!t};var i=new Future,o=i.reject.bind(i);return Future.invoke(e).then(function r(n){Future.invoke(t,null,n).then(function(t){t?Future.invoke(e,null,n).then(r,o):i.resolve(n)},o)},o),i},"static whileDo":function(r,n){return Future.invoke(r).then(function(t){return Future.doWhile(n,r)})},"static delay":function(t,r){t=isNaN(t)?10:Math.max(+t,10),r=void 0===r?Date.now():r;var n=new Future;return setTimeout(n.resolve.bind(n,r),t),n},"static retrying":function(t,r,n,e,i){return(r=isNaN(r)?10:+r)<1?Future.invoke(t):Future.invoke(t).then(void 0,function(){return n=isNaN(n)?100:+n,e=isNaN(e)?2:+e,i=isNaN(i)?3e5:+i,Future.delay(n).then(function(){return Future.retrying(t,r-1,Math.min(i,n*e),e,i)})})},"static imports":function(){var r=new Future;return require(Array.prototype.slice.call(arguments),function(){r.resolve(Array.prototype.slice.call(arguments))},function(t){r.reject(t)}),r}}),when=Future.when,__isFuture__=Future.__isFuture__,HttpRequest=exports.HttpRequest=declare({constructor:function(){this.__request__=new XMLHttpRequest},request:function(t,r,n,e,i,o){var s=this.__request__,a=new Future;return s.open(t,r,!0,i,o),e&&Object.getOwnPropertyNames(e).forEach(function(t){s.setRequestHeader(t,e[t])}),s.onreadystatechange=function(){4==s.readyState&&(200==s.status?a.resolve(s):a.reject(s))},s.send(n),a},get:function(t,r,n,e,i){return this.request("GET",t,r,n,e,i)},getText:function(t,r,n,e,i){return this.get(t,r,n,e,i).then(function(t){return t.responseText})},getJSON:function(t,r,n,e,i){return this.get(t,r,n,e,i).then(function(t){return JSON.parse(t.responseText)})},post:function(t,r,n,e,i){return this.request("POST",t,r,n,e,i)},postJSON:function(t,r,n,e,i){return(n=n||{})["Content-Type"]="application/json",this.post(t,JSON.stringify(r)||"null",n,e,i)}});["request","get","getJSON","getText","post","postJSON"].forEach(function(t){HttpRequest[t]=function(){return HttpRequest.prototype[t].apply(new HttpRequest,arguments)}});var Parallel=exports.Parallel=declare({constructor:function t(r){r||(r=t.newWorker()),r.onmessage=this.__onmessage__.bind(this),this.worker=r},"static newWorker":function newWorker(){var src="self.base = ("+exports.__init__+")();self.onmessage = ("+function(msg){try{self.base.Future.when(eval(msg.data)).then(function(t){self.postMessage(JSON.stringify({result:t}))})}catch(t){self.postMessage(JSON.stringify({error:t+""}))}}+");",blob=new Blob([src],{type:"text/javascript"});return new Worker(URL.createObjectURL(blob))},__onmessage__:function(t){var r=this.__future__;if(r){this.__future__=null;try{var n=JSON.parse(t.data);n.error?r.reject(n.error):r.resolve(n.result)}catch(t){r.reject(t)}}},run:function(t){if(this.__future__)throw new Error("Worker is working!");return this.__future__=new Future,this.worker.postMessage(t+""),this.__future__},"static run":function(t){var r=new Parallel;return r.run(t).always(function(){r.worker.terminate()})},importScripts:function(){return this.run("importScripts("+Array.prototype.slice.call(arguments).map(JSON.stringify).join(",")+");")},loadModule:function(t,r){var n=this;return Future.sequence(r?t.__dependencies__:[],function(t){return n.loadModule(t,r)}).then(function(){return n.run("self."+t.__name__+" || (self."+t.__name__+"=("+t.__init__+")("+t.__dependencies__.map(function(t){return t.__name__}).join(",")+')), "OK"')})},consoleLog:function(t){var r=this.run(t);return r.done(console.log),r}}),Events=exports.Events=declare({constructor:function(t){initialize(this,t).number("maxListeners",{defaultValue:1/0,coerce:!0,minimum:1}).bool("isOpen",{defaultValue:!0});var r=this.__listeners__={};t&&Array.isArray(t.events)&&t.events.forEach(function(t){r[t]=[]})},listeners:function(t){return this.__listeners__.hasOwnProperty(t)?this.__listeners__[t].slice():[]},emit:function(t){var r;if(Array.isArray(t)){var n=this;r=Array.prototype.slice.call(arguments),t.forEach(function(t){r[0]=t,n.emit.apply(this,r)})}if(!this.__listeners__.hasOwnProperty(t))return!1;r=Array.prototype.slice.call(arguments,1);this.__listeners__[t];return this.__listeners__[t]=this.__listeners__[t].filter(function(t){return 0<t[1]&&(setTimeout(function(){return t[0].apply(global,r)},1),t[1]--,0<t[1])}),!0},on:function(t,r,n){if(Array.isArray(t)){var e=this;t.forEach(function(t){e.on(t,r,n)})}else{this.__listeners__.hasOwnProperty(t)||(raiseIf(!this.isOpen,"Event ",t," is not defined."),this.__listeners__[t]=[]);var i=this.__listeners__[t];raiseIf(this.listeners.length>=this.maxListeners,"Cannot have more than ",this.maxListeners," listeners for event ",t,"."),n=+n||1/0,i.push([r,n])}},once:function(t,r){return this.on(t,r,1)},off:function(t,r){if(Array.isArray(t)){var n=this;t.forEach(function(t){n.off(t,r)})}else this.__listeners__.hasOwnProperty(t)&&(this.__listeners__[t]=this.__listeners__[t].filter(function(t){return t[0]!==r}))}}),Randomness=exports.Randomness=declare({constructor:function(t){"function"==typeof t&&(this.__random__=t)},__random__:Math.random,random:function(){var t=this.__random__();switch(arguments.length){case 0:return t;case 1:return t*arguments[0];default:return(1-t)*arguments[0]+t*arguments[1]}},randomInt:function(){return Math.floor(this.random.apply(this,arguments))},randomBool:function(t){return this.random()<(isNaN(t)?.5:+t)},randoms:function(t){var r,n=Array.prototype.slice.call(arguments,1),e=[];for(t=+t,r=0;r<t;r++)e.push(this.random.apply(this,n));return e},choice:function(t){return(t=1<arguments.length?Array.prototype.slice.call(arguments):Array.isArray(t)?t:iterable(t).toArray()).length<1?void 0:t[this.randomInt(t.length)]},choices:function(t,r){return this.split.apply(this,arguments)[0]},split:function(t,r){r=2<arguments.length?Array.prototype.slice.call(arguments):iterable(r).toArray();var n=[];for(t=Math.min(r.length,Math.max(+t,0));0<t;t--)n=n.concat(r.splice(this.randomInt(r.length),1));return[n,r]},shuffle:function(t){return this.choices(t.length,t)},normalizeWeights:function(t){t=iterable(t);var n=0,e=0;return t.forEachApply(function(t,r){raiseIf(r<0,"Cannot normalize with negative weights!"),n+=r,e++}),t.mapApply(function(t,r){return[t,0===n?1/e:r/n]})},weightedChoice:function(t){var n,e=this.random();return iterable(t).forEachApply(function(t,r){(e-=r)<=0&&(n=t,Iterable.stop())}),n},weightedChoices:function(t,e){e=iterable(e).toArray();for(var i,o=1,s=[],r=0;r<t;++r)i=this.random(o),iterable(e).forEachApply(function(t,r,n){(i-=r)<=0&&(s.push(t),o-=r,e.splice(n,1),Iterable.stop())});return s},averagedDistribution:function(n){n=Math.max(+n,2);var e=this.__random__;return new Randomness(function(){for(var t=0,r=0;r<n;r++)t+=e();return t/n})},"static __SERMAT__":{identifier:"Randomness",serializer:function(t){return t.__random__!==Math.random?[t.__random__]:[]},materializer:function(t,r){return r&&(r.length<1?Randomness.DEFAULT:new Randomness(r[0]))}}});Randomness.DEFAULT=new Randomness,["random","randomInt","randomBool","choice","split","choices","shuffle","averagedDistribution"].forEach(function(t){Randomness[t]=Randomness.DEFAULT[t].bind(Randomness.DEFAULT)});var LinearCongruential=Randomness.LinearCongruential=declare(Randomness,{constructor:function(t,r,n,e){var i=isNaN(e)?Date.now():Math.floor(e);this.__arguments__=[t,r,n,i],this.__random__=function(){return(i=(r*i+n)%t)/t}},"static __SERMAT__":{identifier:"LinearCongruential",serializer:function(t){return t.__arguments__}},"static numericalRecipies":function(t){return new LinearCongruential(4294967295,1664525,1013904223,t)},"static borlandC":function(t){return new LinearCongruential(4294967295,22695477,1,t)},"static glibc":function(t){return new LinearCongruential(4294967295,1103515245,12345,t)}});Randomness.MersenneTwister=function(){function i(t){return t<0?t+4294967296:t}return declare(Randomness,{constructor:function(t){this.__seed__=isNaN(t)?Date.now():Math.floor(t);var r=function(t){var r,n=new Array(624);n[0]=r=t;for(var e=1;e<624;++e)n[e]=r=(1812433253*i(r^r<<30)+e)%4294967295;return n}(this.__seed__),n=0;this.__random__=function(){0===n&&function(t){for(var r=0;r<624;++r){var n=2147483648&t[r]|2147483647&t[(r+1)%624];t[r]=i(t[(r+397)%624]^2*n),0!=(1&n)&&(t[r]=i(2567483615^t[r]))}}(r);var t=r[n];return t=i((t=i((t=i((t=i(t^t<<11))^t>>>7&2636928640))^t>>>15&4022730752))^t<<18),n=(n+1)%624,t/4294967295}},"static __SERMAT__":{identifier:"MersenneTwister",serializer:function(t){return[t.__seed__]}}})}();var Chronometer=exports.Chronometer=declare({constructor:function(t){this.reset(t)},reset:function(t){return this.__timestamp__=t||Date.now()},time:function(){return Date.now()-this.__timestamp__},tick:function(t){var r=this.time();return this.reset(t),r},chronometer:function(t,r){r=r||1;for(var n=0,e=0;e<r;e++)this.reset(),t.call(this),n+=this.time();return n/r}}),Statistic=exports.Statistic=declare({constructor:function(t){void 0!==t&&(this.keys="object"==typeof t?null!==t?t:"":t+""),this.reset()},reset:function(){return this.__count__=0,this.__sum__=0,this.__sqrSum__=0,this.__min__=1/0,this.__max__=-1/0,this.__minData__=void 0,this.__maxData__=void 0,this},applies:function(t){if(void 0===t)return!1;if(null===t&&(t=""),void 0===this.keys)return!1;if("object"==typeof this.keys){var r;if("object"==typeof t){if(Array.isArray(this.keys)&&Array.isArray(t)){for(r in t)if(this.keys.indexOf(t[r])<0)return!1}else for(r in t)if(void 0===this.keys[r]||t[r]!==this.keys[r])return!1;return!0}return!1}return"object"!=typeof t&&this.keys===t+""},count:function(){return this.__count__},sum:function(){return this.__sum__},squareSum:function(){return this.__sqrSum__},minimum:function(){return this.__min__},maximum:function(){return this.__max__},minData:function(){return this.__minData__},maxData:function(){return this.__maxData__},average:function(){var t=this.count();return 0<t?this.sum()/t:0},variance:function(t,r){isNaN(r)&&(r=this.average());var n=this.count(),e=1<n?r*r+(this.squareSum()-2*r*this.sum())/n:0;return t||n<2?e:e*n/(n-1)},standardDeviation:function(t,r){return Math.sqrt(this.variance(r),t)},add:function(t,r){return void 0===t?t=1:isNaN(t)&&raise("Statistics.add(): Value ",t," cannot be added."),this.__count__+=1,this.__sum__+=t,this.__sqrSum__+=t*t,this.__min__>t&&(this.__min__=t,this.__minData__=r),this.__max__<t&&(this.__max__=t,this.__maxData__=r),this},addAll:function(t,r){for(var n=0;n<t.length;n++)this.add(t[n],r);return this},gain:function(t,r,n){return r=isNaN(r)?this.DEFAULT_GAIN_FACTOR:+r,this.__count__*=r,this.__sum__*=r,this.__sqrSum__*=r,this.add(t,n)},DEFAULT_GAIN_FACTOR:.99,gainAll:function(t,r,n){for(var e=0;e<t.length;e++)this.gain(t[e],r,n);return this},addStatistic:function(t){return this.__count__+=t.__count__,this.__sum__+=t.__sum__,this.__sqrSum__+=t.__sqrSum__,t.__min__<this.__min__&&(this.__min__=t.__min__,this.__maxData__=t.__maxData__),t.__max__>this.__max__&&(this.__max__=t.__max__,this.__maxData__=t.__maxData__),this},startTime:function(t){return(this.__chronometer__||(this.__chronometer__=new Chronometer)).reset(t)},addTime:function(t){return raiseIf(!this.__chronometer__,"Statistic's chronometer has not been started."),this.add(this.__chronometer__.time(),t)},addTick:function(t){return raiseIf(!this.__chronometer__,"Statistic's chronometer has not been started."),this.add(this.__chronometer__.tick(),t)},"static z_test":function(t,r,n,e){var i={},o=i.z=(e-t)/Math.sqrt(r/n),s=math.gauss_cdf(o);return i.p_lessThan=o<0?s:0,i.p_greaterThan=0<o?1-s:0,i.p_notEqual=0!==o?2*Math.max(i.p_lessThan,i.p_greaterThan):0,i},z_test:function(t,r){return r=isNaN(r)?this.variance():+r,Statistic.z_test(t,r,this.count(),this.average())},"static t_test1":function(t,r,n,e){return{t:(n-t)/e*Math.sqrt(r)}},t_test1:function(t,r,n,e){return Statistic.t_test1(isNaN(t)?0:+t,isNaN(r)?this.count():+r,isNaN(n)?this.average():+n,isNaN(e)?this.standardDeviation():+e)},"static t_test2":function(t,r,n,e,i,o){var s=((t-1)*i+(r-1)*o)/(t+r-2);return{t:(n-e)/Math.sqrt(s*(1/t+1/r))}},t_test2:function(t){return Statistic.t_test2(this.count(),t.count(),this.average(),t.average(),this.variance(),t.variance())},toString:function(t){return t=""+(t||"\t"),["object"!=typeof this.keys?this.keys+"":iterable(this.keys).map(function(t){return t[0]+":"+t[1]}).join(", "),this.count(),this.minimum(),this.average(),this.maximum(),this.standardDeviation()].join(t)},"static __SERMAT__":{identifier:"Statistic",serializer:function(t){var r=[t.keys||null,t.__count__,t.__sum__,t.__sqrSum__,t.__min__,t.__max__];return void 0!==t.__minData__?r.concat([t.__minData__,t.__maxData__]):r},materializer:function(t,r){if(!r)return null;var n=r[0]?new Statistic(r[0]):new Statistic;return n.__count__=+r[1],n.__sum__=+r[2],n.__sqrSum__=+r[3],n.__min__=+r[4],n.__max__=+r[5],0<n.__count__&&(n.__minData__=r[6],n.__maxData__=r[7]),n}}}),Statistics=exports.Statistics=declare({constructor:function(){this.__stats__={}},__id__:function(r){return"object"==typeof r&&null!==r?Array.isArray(r)?JSON.stringify(r.slice().sort()):Object.keys(r).sort().map(function(t){return JSON.stringify(t)+":"+JSON.stringify(r[t])}).join(","):JSON.stringify(r)+""},stats:function(r){return iterable(this.__stats__).map(function(t){return t[1]},function(t){return t.applies(r)}).toArray()},stat:function(t){var r=this.__id__(t);return this.__stats__[r]||(this.__stats__[r]=new Statistic(t))},addObject:function(t,r){for(var n in raiseIf(!t,"Cannot add object "+JSON.stringify(t)+"."),t)Array.isArray(t[n])?this.addAll(n,t[n],r):this.add(n,t[n],r);return this},addStatistic:function(t,r){return this.stat(void 0!==r?r:t.keys).addStatistic(t)},addStatistics:function(t,r){var n=this;return t.stats(r).forEach(function(t){n.stat(t.keys).addStatistic(t)}),this},reset:function(t){return this.stats(t).forEach(function(t){t.reset()}),this},add:function(t,r,n){return this.stat(t).add(r,n)},gain:function(t,r,n,e){return this.stat(t).gain(r,n,e)},addAll:function(t,r,n){return this.stat(t).addAll(r,n)},gainAll:function(t,r,n,e){return this.stat(t).addAll(r,e)},startTime:function(t,r){return this.stat(t).startTime(r)},addTime:function(t,r){return this.stat(t).addTime(r)},addTick:function(t,r){return this.stat(t).addTick(r)},accumulation:function(t){var r=new Statistic(t);return this.stats(t).forEach(function(t){r.addStatistic(t)}),r},count:function(t){return this.accumulation(t).count()},sum:function(t){return this.accumulation(t).sum()},squareSum:function(t){return this.accumulation(t).squareSum()},minimum:function(t){return this.accumulation(t).minimum()},maximum:function(t){return this.accumulation(t).maximum()},average:function(t){return this.accumulation(t).average()},variance:function(t,r){return this.accumulation(t).variance(r)},standardDeviation:function(t,r){return this.accumulation(t).standardDeviation(r)},toString:function(r,t){r=""+(r||"\t"),t=""+(t||"\n");var n=this.__stats__;return Object.keys(n).map(function(t){return n[t].toString(r)}).join(t)},"static __SERMAT__":{identifier:"Statistics",serializer:function(t){var r=t.__stats__;return Object.keys(r).map(function(t){return r[t]})},materializer:function(t,r){if(!r)return null;var n=new Statistics;return r.forEach(function(t){n.addStatistic(t)}),n}}}),Logger=exports.Logger=declare({constructor:function t(r,n,e){this.name=""+r,this.parent=n||t.ROOT,this.level=e||"INFO",this.appenders=[]},log:function(r){var t=this.LEVELS[this.level]<=this.LEVELS[r];if(t){var n=this,e=Array.prototype.slice.call(arguments,1).join("");this.appenders.forEach(function(t){t((t.format||n.defaultFormat)(n.name,new Date,r,e))}),this.parent&&this.parent.log.apply(this.parent,arguments)}return t},LEVELS:{TRACE:-1/0,DEBUG:-1,INFO:0,WARN:1,ERROR:2,FATAL:1/0,OK:0,FAIL:1,TODO:1,FIXME:1},trace:function(){return this.log("TRACE",Array.prototype.slice.call(arguments,0).join(""))},debug:function(){return this.log("DEBUG",Array.prototype.slice.call(arguments,0).join(""))},info:function(){return this.log("INFO",Array.prototype.slice.call(arguments,0).join(""))},warn:function(){return this.log("WARN",Array.prototype.slice.call(arguments,0).join(""))},error:function(){return this.log("ERROR",Array.prototype.slice.call(arguments,0).join(""))},fatal:function(){return this.log("FATAL",Array.prototype.slice.call(arguments,0).join(""))},defaultFormat:function(t,r,n,e){return[n,t,Text.formatDate(r,"hhnnss.SSS"),e].join(" ")},htmlFormat:function(i,o){return i=i||"p",o=o||"log_",function(t,r,n,e){return["<",i,' class="',o,n,'">','<span class="',o,'level">',n,"</span> ",'<span class="',o,'name">',t,"</span> ",'<span class="',o,'time">',Text.formatDate(r,"hhnnss.SSS"),"</span> ",'<span class="',o,'message">',Text.escapeXML(e).replace(/\n/g,"<br/>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;"),"</span>","</",i,">"].join("")}},appendToConsole:function(){function t(t){console.log(t)}return function(){return this.appenders.push(t),t}}(),appendToFile:function(t,r,n){t=t||"./log"+(new Date).format("yyyymmdd-hhnnss")+".log",r=void 0!==r?r:"a",n=void 0!==n?n:"utf-8";var e=require("fs").createWriteStream(t,{flags:r,encoding:n});function i(t){e.write(t+"\n")}return this.appenders.push(i),i},appendToHtml:function(r,n,e){n=+n||1/0,e=!!e,r="string"==typeof r?document.getElementById(r):r||document.getElementsByTagName("body")[0];var i=[];function t(t){if(e)for(i.unshift(t);i.length>n;)i.pop();else for(i.push(t);i.length>n;)i.shift();r.innerHTML=i.join("\n")}return this.appenders.push(t),t},appendAsWorkerMessages:function(n){function t(t){var r={};r[n]=t,self.postMessage(JSON.stringify(r))}return n=""+(n||"log"),t.format=function(t,r,n,e){return{name:t,time:r,level:n,message:e}},this.appenders.push(t),t},stats:function(){return this.__stats__||(this.__stats__=new Statistics)}});return Logger.ROOT=new Logger(""),[Randomness,Randomness.LinearCongruential,Randomness.MersenneTwister,Statistic,Statistics].forEach(function(t){t.__SERMAT__.identifier=exports.__package__+"."+t.__SERMAT__.identifier,exports.__SERMAT__.include.push(t)}),exports});
//# sourceMappingURL=creatartis-base.min.js.map